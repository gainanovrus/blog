<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.3 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>DELL. Configure Dell 10 gigabit switch with Ansible - GAINANOV.PRO</title>
<meta name="description" content="Use Ansible playbooks to easy configure Dell Networking OS9 system. The post contains many practical examples of using dellos9 modules">


  <meta name="author" content="Ruslan Gainanov">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="GAINANOV.PRO">
<meta property="og:title" content="DELL. Configure Dell 10 gigabit switch with Ansible">
<meta property="og:url" content="https://gainanov.pro/eng-blog/devops/dell-ansible-playbook/">


  <meta property="og:description" content="Use Ansible playbooks to easy configure Dell Networking OS9 system. The post contains many practical examples of using dellos9 modules">





  <meta name="twitter:site" content="@gainanovrus">
  <meta name="twitter:title" content="DELL. Configure Dell 10 gigabit switch with Ansible">
  <meta name="twitter:description" content="Use Ansible playbooks to easy configure Dell Networking OS9 system. The post contains many practical examples of using dellos9 modules">
  <meta name="twitter:url" content="https://gainanov.pro/eng-blog/devops/dell-ansible-playbook/">

  
    <meta name="twitter:card" content="summary">
    
  

  



  <meta property="article:published_time" content="2020-08-01T00:00:00+03:00">





  

  


<link rel="canonical" href="https://gainanov.pro/eng-blog/devops/dell-ansible-playbook/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Ruslan Gainanov",
      "url": "https://gainanov.pro/eng-blog/",
      "sameAs": ["https://www.facebook.com/gainanovrus","https://twitter.com/gainanovrus","https://linkedin.com/in/gainanovrus"]
    
  }
</script>


  <meta name="google-site-verification" content="Wq8i7X_W6EpXbttUnWRWiok4EyvFVb-nyUaY_kDLDMc" />




  <meta name="yandex-verification" content="cfbcdd4107182b42">


<!-- end _includes/seo.html -->


<link href="/eng-blog/feed.xml" type="application/atom+xml" rel="alternate" title="GAINANOV.PRO Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/eng-blog/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


  
    <script src="/eng-blog/assets/js/buttons.js"></script>
  


    <!-- start custom head snippets -->
<!-- <link href="/assets/css/tagcloud04.css" rel="stylesheet" type="text/css"> -->
<link href="https://gainanov.pro/favicon.ico" rel="icon" type="image/x-icon" />

<!-- Add style to button that change languages (GR) -->
<link rel="stylesheet" href="/eng-blog/assets/css/language-button.css">

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115465350-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115465350-1');
</script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
   (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
   m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
   (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

   ym(57089593, "init", {
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true
   });
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57089593" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <!-- Change language button (GR) -->
        <a title="Change to RUS" class="language-button" style="margin-left: 0px;" onclick="location.pathname = '/rus-blog';" role="button"></a>
        <a class="site-title" href="/eng-blog/">GAINANOV.PRO</a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/eng-blog/categories/" >Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/eng-blog/tags/" >Tags</a>
            </li><li class="masthead__menu-item">
              <a href="/eng-blog/portfolio/" >Portfolio</a>
            </li><li class="masthead__menu-item">
              <a href="/eng-blog/about/" >About me</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/eng-blog/assets/images/author-150x150.jpg" alt="Ruslan Gainanov" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Ruslan Gainanov</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>System &amp; Software engineer</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
            <li><a href="https://linkedin.com/in/gainanovrus" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
      

      
        <li>
          <a href="http://gainanov.pro" itemprop="url">
            <i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span>
          </a>
        </li>
      

      
        <li>
          <a href="mailto:gromrx1@gmail.com">
            <meta itemprop="email" content="gromrx1@gmail.com" />
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
      

      

    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="DELL. Configure Dell 10 gigabit switch with Ansible">
    <meta itemprop="description" content="Use Ansible playbooks to easy configure Dell Networking OS9 system. The post contains many practical examples of using dellos9 modules">
    <meta itemprop="datePublished" content="2020-08-01T00:00:00+03:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">DELL. Configure Dell 10 gigabit switch with Ansible
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  7 minute read

</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu">
  <li><a href="#prerequisites">Prerequisites</a></li>
  <li><a href="#tested-environment">Tested Environment</a></li>
  <li><a href="#inventory">Inventory</a></li>
  <li><a href="#playbook">Playbook</a></li>
  <li><a href="#tasks">Tasks</a>
    <ul>
      <li><a href="#dellos9_facts">dellos9_facts</a></li>
      <li><a href="#dellos9_command">dellos9_command</a></li>
      <li><a href="#dellos9_config">dellos9_config</a></li>
    </ul>
  </li>
  <li><a href="#galaxy-roles">Galaxy roles</a></li>
  <li><a href="#conclusion">Conclusion</a></li>
  <li><a href="#additional-information">Additional information</a></li>
</ul>

            </nav>
          </aside>
        
        <p>Today I would like to talk how to easy configure a network switch with Ansible.
In the past when no one listens about “Infrastructure as a Code” (IaaC) methodology we setuping our devices throw console.
We type command by command successively. We copy configure scripts and edit them on device. It’s good, but when you configure many devices you often will mistakes.</p>

<p>Today with a very beautiful utility as Ansible. We could automate many actions, that we make manually earlier.
Futhermore we can configure a network switches like Dell and Cisco too. Ansible has a specific modules for these things.</p>

<p>If you already familiar with Ansible you will see how it come easy.
Soo in this post I want to share my experience about it. It will include many practical examples.
All code sketches has been tested by me on <a href="https://i.dell.com/sites/doccontent/shared-content/data-sheets/en/Documents/Dell-EMC-Networking-S4048-ON-Spec-Sheet.pdf">Dell S4048</a> 10-gigabit switch.</p>

<h2 id="prerequisites">Prerequisites</h2>

<p>These examples requires the following:</p>
<ul>
  <li>Ansible 2.5 (or higher) installed. See Installing Ansible for more information.</li>
  <li>Dell OS9 platform device.</li>
  <li>Basic understanding of YAML Syntax.</li>
  <li>Basic Linux command line use.</li>
  <li>Basic knowledge of network switch &amp; router configurations.</li>
</ul>

<p>You should have enabled SSH-server. See my <a href="/eng-blog/sysad/dell-ssh-server-configure/">previous post</a> about configuring it.
It is not difficult.
Also you should append the connection rate by SSH on the network device.
Use the command below to configure the maximum number of incoming SSH connections per minute.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># ip ssh connection-rate-limit 60
</code></pre></div></div>

<h2 id="tested-environment">Tested Environment</h2>

<ul>
  <li>Dell Switch S4048 (OS9 Network System v.9.14)</li>
  <li>Ansible 2.9.11 with Python 3.8 runs on MacOS</li>
</ul>

<h2 id="inventory">Inventory</h2>

<p>All Ansible tasks started with adding a new host into <a href="https://gainanov.pro/eng-blog/devops/ansible-architecture/#1-inventory">Inventory file</a>.</p>

<p>I prefer to use inventory stored in YAML format. This is mine (stored in <code class="language-plaintext highlighter-rouge">hosts</code> file):</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">...</span>
  <span class="na">hosts</span><span class="pi">:</span>
    <span class="na">switch10g_new</span><span class="pi">:</span>
      <span class="na">ansible_host</span><span class="pi">:</span> <span class="s">192.168.1.10</span>
      <span class="na">ansible_user</span><span class="pi">:</span> <span class="s">admin</span>
      <span class="na">ansible_network_os</span><span class="pi">:</span> <span class="s">dellos9</span>
</code></pre></div></div>

<p>This piece has told Ansible that the host named <code class="language-plaintext highlighter-rouge">switch10g_new</code> should be accessible by selected IP and user name.</p>

<p>Before continue writing a playbook try to connect with your credentials to the device.
You should connecting throw ssh with command (<code class="language-plaintext highlighter-rouge">ssh admin@192.168.1.10</code>) from your local device without any problem.</p>

<h2 id="playbook">Playbook</h2>

<p>My playbook (saved on <code class="language-plaintext highlighter-rouge">dell-switch-playbook.yml</code> file) consists of the next rows:</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">hosts</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">switch10g_new</span>
  <span class="na">gather_facts</span><span class="pi">:</span> <span class="s">no</span>
  <span class="na">connection</span><span class="pi">:</span> <span class="s">local</span>
  <span class="na">roles</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">role</span><span class="pi">:</span> <span class="s">dell</span>
</code></pre></div></div>

<p>I have just run a role named <code class="language-plaintext highlighter-rouge">dell</code>. But in the real life do not use this name for the role.</p>

<p>The role <code class="language-plaintext highlighter-rouge">dell</code> include many tasks.</p>

<h2 id="tasks">Tasks</h2>

<p>Let’s run some simple tasks. Open Ansible documentation and found a part about network modules.</p>

<p>Modules for <a href="https://docs.ansible.com/ansible/latest/modules/list_of_network_modules.html#dellos9">Dell OS9 series</a> devices includes these three modules:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">dellos9_command</code> – Run commands on remote devices running Dell OS9</li>
  <li><code class="language-plaintext highlighter-rouge">dellos9_config</code> – Manage Dell EMC Networking OS9 configuration sections</li>
  <li><code class="language-plaintext highlighter-rouge">dellos9_facts</code> – Collect facts from remote devices running Dell EMC Networking OS9</li>
</ul>

<p>Try to use them and see that we can make with. I will start from the end of the list.</p>

<h3 id="dellos9_facts">dellos9_facts</h3>

<p>This <a href="https://docs.ansible.com/ansible/latest/modules/dellos9_facts_module.html#dellos9-facts-module">module</a> collect a base set of device facts from a remote device. All fact keys prepends with <code class="language-plaintext highlighter-rouge">ansible_net_&lt;fact&gt;</code>.</p>

<ul>
  <li>Task to see on your local console the facts of remote device</li>
</ul>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Collect all facts from the device</span>
  <span class="na">dellos9_facts</span><span class="pi">:</span>
    <span class="c1"># all, hardware, config, and interfaces</span>
    <span class="c1"># '!' to specify that a specific subset should not be collected.</span>
    <span class="c1"># gather_subset: ["all"]</span>
    <span class="c1"># gather_subset: ["config", "hardware"]</span>
    <span class="na">gather_subset</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">all"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">!interfaces"</span><span class="pi">]</span>
  <span class="na">register</span><span class="pi">:</span> <span class="s">dellos9_facts</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Show dellos9_facts</span>
  <span class="na">debug</span><span class="pi">:</span>
    <span class="na">var</span><span class="pi">:</span> <span class="s">dellos9_facts</span>
</code></pre></div></div>

<ul>
  <li>The result of the command will presented below:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ok: [switch10g_new] =&gt; {
"dellos9_facts": {
    "ansible_facts": {
        "ansible_net_config": "Current Configuration ...",
        "ansible_net_filesystems": [
            "flash",
            "fcmfs",
            "nfsmount",
            "ftp",
            "tftp",
            "scp",
            "http",
            "https"
        ],
        "ansible_net_gather_subset": [
            "hardware",
            "default",
            "config"
        ],
        "ansible_net_hostname": "DellEMC",
        "ansible_net_image": "system://A",
        "ansible_net_memfree_mb": 3123970,
        "ansible_net_memtotal_mb": 3126272,
        "ansible_net_model": "S4048-ON ",
        "ansible_net_serialnum": "NA",
        "ansible_net_version": "9.14(2.7)"
    },
    "changed": false,
    "failed": false
}
}
</code></pre></div>    </div>
  </li>
  <li>Task related with previous to save a switch configuration to your local directory <code class="language-plaintext highlighter-rouge">files/</code></li>
</ul>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Save an active config from the device to localhost</span>
  <span class="na">vars</span><span class="pi">:</span>
    <span class="na">running_config</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">dellos9_facts['ansible_facts']['ansible_net_config']</span><span class="nv"> </span><span class="s">}}"</span>
  <span class="na">local_action</span><span class="pi">:</span>
    <span class="na">module</span><span class="pi">:</span> <span class="s">copy</span>
    <span class="na">content</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">running_config</span><span class="nv"> </span><span class="s">}}"</span>
    <span class="na">dest</span><span class="pi">:</span> <span class="s2">"</span><span class="s">files/running_config_{{</span><span class="nv"> </span><span class="s">inventory_hostname</span><span class="nv"> </span><span class="s">}}"</span>
</code></pre></div></div>

<h3 id="dellos9_command">dellos9_command</h3>

<p>The module <a href="https://docs.ansible.com/ansible/latest/modules/dellos9_command_module.html#dellos9-command-module"><code class="language-plaintext highlighter-rouge">dellos9_command</code></a> sends commands to the host and returns the results read from the device.
You should know that this module does not support running commands in CONF mode.</p>

<p>It useful to show something about your device.</p>

<ul>
  <li>Task for getting a device version</li>
</ul>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Detect a device version</span>
  <span class="na">dellos9_command</span><span class="pi">:</span>
    <span class="na">commands</span><span class="pi">:</span> <span class="s">show version</span>
  <span class="na">register</span><span class="pi">:</span> <span class="s">show_ver</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">show version command output</span>
  <span class="na">debug</span><span class="pi">:</span>
    <span class="na">var</span><span class="pi">:</span> <span class="s">show_ver.stdout_lines</span>
</code></pre></div></div>

<ul>
  <li>The result will be like:</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TASK [dell : show version command output]***************************************
ok: [switch10g_new] =&gt; {
    "show_ver.stdout_lines": [
        [
            "Dell EMC Real Time Operating System Software",
            "Dell EMC Operating System Version:  2.0",
            "Dell EMC Application Software Version:  9.14(2.7)",
            "Dell EMC Networking OS uptime is 56 minute(s)",
            "",
            "System Type: S4048-ON ",
            "",
            "8G bytes of boot flash memory.",
            "",
            "  1 54-port TE/FG (SK-ON)",
            " 48 Ten GigabitEthernet/IEEE 802.3 interface(s)",
            "  6 Forty GigabitEthernet/IEEE 802.3 interface(s)"
        ]
    ]
}
</code></pre></div></div>

<ul>
  <li>Or task to see a device time</li>
</ul>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Get device clock</span>
  <span class="na">dellos9_command</span><span class="pi">:</span>
    <span class="na">commands</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">show clock</span>
  <span class="na">register</span><span class="pi">:</span> <span class="s">show_clock</span>
<span class="pi">-</span> <span class="na">debug</span><span class="pi">:</span> <span class="s">var=show_clock.stdout</span>
</code></pre></div></div>

<p>Now we ready using a module that will change a state, that will edit a configuration of the device</p>

<h3 id="dellos9_config">dellos9_config</h3>

<p>The module <a href="https://docs.ansible.com/ansible/latest/modules/dellos9_config_module.html#dellos9-config-module"><code class="language-plaintext highlighter-rouge">dellos9_config</code></a> writes a blocks of code into your device configuration. It has <code class="language-plaintext highlighter-rouge">before</code> and <code class="language-plaintext highlighter-rouge">after</code> parameters to exactly point the place where your code should saved.</p>

<ul>
  <li>Task for changing an interface configuration</li>
</ul>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Enable</span><span class="nv"> </span><span class="s">interface</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">dhcp</span><span class="nv"> </span><span class="s">client</span><span class="nv"> </span><span class="s">on</span><span class="nv"> </span><span class="s">port</span><span class="nv"> </span><span class="s">te1/1"</span>
  <span class="na">dellos9_config</span><span class="pi">:</span>
    <span class="na">lines</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">ip</span><span class="nv"> </span><span class="s">address</span><span class="nv"> </span><span class="s">dhcp'</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">no</span><span class="nv"> </span><span class="s">shutdown'</span>
    <span class="na">parents</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">interface</span><span class="nv"> </span><span class="s">TenGigabitEthernet</span><span class="nv"> </span><span class="s">1/1'</span>
  <span class="na">register</span><span class="pi">:</span> <span class="s">enable_interface</span>
<span class="pi">-</span> <span class="na">debug</span><span class="pi">:</span> <span class="s">var=enable_interface</span>
</code></pre></div></div>

<ul>
  <li>The result of the task:</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TASK [dell : Enable interface and dhcp client on port te1/1] *******************
changed: [switch10g_new]

TASK [dell : debug] ************************************************************
ok: [switch10g_new] =&gt; {
    "enable_interface": {
        "changed": true,
        "commands": [
            "interface TenGigabitEthernet 1/1",
            "ip address dhcp",
            "no shutdown"
        ],
        "failed": false,
        "saved": false,
        "updates": [
            "interface TenGigabitEthernet 1/1",
            "ip address dhcp",
            "no shutdown"
        ]
    }
}
</code></pre></div></div>

<p>Also it useful to run some actions that acquire to input answer to a prompt.</p>

<ul>
  <li>Task for saving running_config to startup_config</li>
</ul>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Copy</span><span class="nv"> </span><span class="s">running-config</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">startup-config</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">Dell</span><span class="nv"> </span><span class="s">EMC</span><span class="nv"> </span><span class="s">OS9</span><span class="nv"> </span><span class="s">Device"</span>
  <span class="na">dellos9_config</span><span class="pi">:</span>
    <span class="na">lines</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">command</span><span class="pi">:</span> <span class="s">do copy running-config startup-config</span>
        <span class="na">prompt</span><span class="pi">:</span> <span class="s1">'</span><span class="s">\[confirm</span><span class="nv"> </span><span class="s">yes/no\]:\s?$'</span>
        <span class="na">answer</span><span class="pi">:</span> <span class="s2">"</span><span class="s">yes"</span>
</code></pre></div></div>

<h2 id="galaxy-roles">Galaxy roles</h2>

<p>Dell EMC Open-Source Community in <a href="https://github.com/Dell-Networking">Github</a> provides many Galaxy roles.
But it is just a wrapper on the modules explained earlier.
It provide a good interface to edit a network configure as structured YAML variables stored in files.
See a full list of the Galaxy roles <a href="https://ansible-dellos-docs.readthedocs.io/en/latest/roles.html">here</a></p>

<p>To use these Dell Galaxy roles you need to download them. Define all roles that you want download into a file like <a href="/eng-blog/assets/files/dell/dellemc_roles.yml">this mine</a>. I prefer to save an all external roles into a local directory <code class="language-plaintext highlighter-rouge">./ansible_roles</code>.
So this file I will save into this directory. After that run a command to download them:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ansible-galaxy install -r ansible-roles/dellemc_roles.yml
</code></pre></div></div>

<p>Next write a new playbook to run some tasks defined in the downloaded Galaxy roles.</p>

<ul>
  <li>Playbook - <code class="language-plaintext highlighter-rouge">dell-switch-configure.yml</code></li>
</ul>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">hosts</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">switch10g_new</span>
  <span class="na">gather_facts</span><span class="pi">:</span> <span class="s">no</span>
  <span class="c1"># become: yes</span>
  <span class="c1"># become_method: enable</span>
  <span class="na">connection</span><span class="pi">:</span> <span class="s">local</span>
  <span class="c1"># connection: network_cli</span>

  <span class="na">roles</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">role</span><span class="pi">:</span> <span class="s">ansible-roles/Dell-Networking.dellos-system</span>
    <span class="pi">-</span> <span class="na">role</span><span class="pi">:</span> <span class="s">ansible-roles/Dell-Networking.dellos-interface</span>
    <span class="pi">-</span> <span class="na">role</span><span class="pi">:</span> <span class="s">ansible-roles/Dell-Networking.dellos-vlan</span>
</code></pre></div></div>

<ul>
  <li>Host variables - <code class="language-plaintext highlighter-rouge">host_vars/switch10g_new.yaml</code></li>
</ul>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># https://galaxy.ansible.com/Dell-Networking/dellos-system</span>
<span class="na">dellos_system</span><span class="pi">:</span>
  <span class="na">hostname</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">inventory_hostname</span><span class="nv"> </span><span class="s">}}"</span>

<span class="c1"># https://galaxy.ansible.com/Dell-Networking/dellos-interface</span>
<span class="na">dellos_interface</span><span class="pi">:</span>
    <span class="c1"># interface TenGigabitEthernet 1/22</span>
    <span class="c1">#   description T-GPU1</span>
    <span class="c1">#   no ip address</span>
    <span class="c1">#   portmode hybrid</span>
    <span class="c1">#   switchport</span>
    <span class="c1">#   no shutdown</span>
    <span class="s">TenGigabitEthernet 1/22</span><span class="pi">:</span>
      <span class="na">desc</span><span class="pi">:</span> <span class="s2">"</span><span class="s">T-GPU1"</span>
      <span class="na">ip_and_mask</span><span class="pi">:</span>  <span class="c1"># set up `no ip address`</span>
      <span class="na">portmode</span><span class="pi">:</span> <span class="s">hybrid</span>  <span class="c1"># pass both untagged and tagged VLANs</span>
      <span class="na">switchport</span><span class="pi">:</span> <span class="no">true</span>
      <span class="c1"># ip_type_dynamic: true # Configures IP address DHCP if set to true (ip_and_mask is ignored if set to true)</span>
      <span class="c1"># ip_and_mask: 192.168.23.22/24 # Configures the specified IP address (192.168.11.1/24 format)</span>
      <span class="na">admin</span><span class="pi">:</span> <span class="s">up</span>  <span class="c1"># enables the interface</span>

    <span class="c1"># interface Port-channel 1</span>
    <span class="c1">#   no ip address</span>
    <span class="c1">#   switchport</span>
    <span class="c1">#   no shutdown</span>
    <span class="na">port-channel 1</span><span class="pi">:</span>
      <span class="na">ip_and_mask</span><span class="pi">:</span>
      <span class="na">switchport</span><span class="pi">:</span> <span class="no">true</span>
      <span class="na">admin</span><span class="pi">:</span> <span class="s">up</span>

    <span class="c1"># interface Vlan 3</span>
    <span class="c1">#  description C-DATA</span>
    <span class="c1">#  no ip address</span>
    <span class="c1">#  tagged Port-channel 1</span>
    <span class="c1">#  untagged TenGigabitEthernet 1/22</span>
    <span class="c1">#  no shutdown</span>
    <span class="na">vlan 3</span><span class="pi">:</span>
      <span class="na">desc</span><span class="pi">:</span> <span class="s2">"</span><span class="s">C-DATA"</span>
      <span class="na">ip_and_mask</span><span class="pi">:</span>
      <span class="c1"># to configure vlan use dellos-vlan role (see next)</span>
      <span class="na">admin</span><span class="pi">:</span> <span class="s">up</span>

<span class="c1"># https://galaxy.ansible.com/Dell-Networking/dellos-vlan</span>
<span class="na">dellos_vlan</span><span class="pi">:</span>
    <span class="na">vlan 3</span><span class="pi">:</span>
      <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">C-DATA"</span>
      <span class="na">tagged_members</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">port</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Port-channel</span><span class="nv"> </span><span class="s">1"</span>
          <span class="na">state</span><span class="pi">:</span> <span class="s">present</span>
      <span class="na">untagged_members</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">port</span><span class="pi">:</span> <span class="s2">"</span><span class="s">TenGigabitEthernet</span><span class="nv"> </span><span class="s">1/22"</span>
          <span class="na">state</span><span class="pi">:</span> <span class="s">present</span>
      <span class="na">state</span><span class="pi">:</span> <span class="s">present</span>
</code></pre></div></div>

<ul>
  <li>Explanation of tasks
This playbook set up a hostname of a device as inventory hostname. After that it configures interfaces <code class="language-plaintext highlighter-rouge">te1/22</code>, <code class="language-plaintext highlighter-rouge">po1</code> and <code class="language-plaintext highlighter-rouge">vlan 3</code>. If it does not existing it will create. Next we add members to created <code class="language-plaintext highlighter-rouge">vlan 3</code>.</li>
</ul>

<p>This YAML-file easy to read and it explains capability and power of these galaxy roles. Read more about them in <a href="https://ansible-dellos-docs.readthedocs.io/en/latest/roles.html">Documentation pages</a>.</p>

<h2 id="conclusion">Conclusion</h2>

<p>In this post I explain the configuration process of network device without console.
With Ansible you can make changes with many devices in one time.
File of configuration easy to read (because it stored in YAML). All tasks could be saved into Git repository.
Futhermore it could possible to update and apply changes with your CI/CD tool.</p>

<p>Also I save all sources into <a href="https://github.com/GRomR1/dell-ansible-playbook">GitHub</a>. You can read all practical examples and clone it.</p>

<h2 id="additional-information">Additional information</h2>

<ul>
  <li><a href="https://galaxy.ansible.com/Dell-Networking">Dell-Networking page on Ansible Galaxy</a> - where placed all galaxy roles written by Community</li>
  <li><a href="https://ansible-dellos-docs.readthedocs.io/en/latest/intro.html">Dell Command Line Reference Guide for the S4048–ON System</a> - Dell documentation explains Dell EMC Ansible integration</li>
  <li><a href="https://docs.ansible.com/ansible/latest/modules/list_of_network_modules.html#dellos9">Dellos9 page on Ansible Modules</a> - read more about explained modules</li>
  <li><a href="https://github.com/Dell-Networking/ansible-dellos-examples">GitHub - Dell-Networking - ansible-dellos-examples</a> - Sample Ansible playbooks to understand how the Dell EMC Networking Anisble Module works.</li>
</ul>


        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/eng-blog/tags/ansible" class="page__taxonomy-item" rel="tag">ansible</a><span class="sep">, </span>
    
      
      
      <a href="/eng-blog/tags/dell" class="page__taxonomy-item" rel="tag">dell</a><span class="sep">, </span>
    
      
      
      <a href="/eng-blog/tags/devops" class="page__taxonomy-item" rel="tag">devops</a><span class="sep">, </span>
    
      
      
      <a href="/eng-blog/tags/networks" class="page__taxonomy-item" rel="tag">networks</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/eng-blog/categories/devops" class="page__taxonomy-item" rel="tag">devops</a>
    
    </span>
  </p>


        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-08-01T00:00:00+03:00">August 1, 2020</time></p>


      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?via=gainanovrus&text=DELL.+Configure+Dell+10+gigabit+switch+with+Ansible%20https%3A%2F%2Fgainanov.pro%2Feng-blog%2Fdevops%2Fdell-ansible-playbook%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fgainanov.pro%2Feng-blog%2Fdevops%2Fdell-ansible-playbook%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fgainanov.pro%2Feng-blog%2Fdevops%2Fdell-ansible-playbook%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/eng-blog/sysad/dell-switch-upgrade-firmware/" class="pagination--pager" title="DELL. Upgrade firmware on Dell S4048 switch (S-series, OS9)
">Previous</a>
    
    
      <a href="#" class="pagination--pager disabled">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/eng-blog/sysad/dell-switch-upgrade-firmware/" rel="permalink">DELL. Upgrade firmware on Dell S4048 switch (S-series, OS9)
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  3 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">Instructions for upgrading the last firmware of Dell Networking system.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/eng-blog/sysad/dell-smartassist-disable/" rel="permalink">DELL. Disabling SupportAssist on switch
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  3 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">SupportAssist is a daemon for sending technical reports to Dell servers. It enables by default. Here we disable this unwanted feature (and may be unsecured).
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/eng-blog/sysad/dell-ssh-server-configure/" rel="permalink">DELL. Setup SSH server on OS9 switch (S4048 10G switch)
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  3 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">Setup and configure ssh server on Dell Networking system with RSA and password authentication.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/eng-blog/sysad/dell-file-management/" rel="permalink">DELL. File Management on S4048 switch (OS9-series system)
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  4 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">Some useful notes for working with files (save, copy and transfer) on Dell Networking system.
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-copyright">&copy; 2020 Ruslan Gainanov. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/eng-blog/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>




<script src="/eng-blog/assets/js/lunr/lunr.min.js"></script>
<script src="/eng-blog/assets/js/lunr/lunr-store.js"></script>
<script src="/eng-blog/assets/js/lunr/lunr-en.js"></script>







  </body>
</html>
